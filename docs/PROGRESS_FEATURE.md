# 任务进展功能文档

## 功能概述

NextDo 现已支持任务进展跟踪功能，允许用户为每个任务设置和查看当前进展状态。

## 任务进展状态

系统支持以下六种进展状态：

| 状态名称 | 说明 | 颜色标识 |
|---------|------|---------|
| Initial | 初始状态，任务刚创建 | 灰色 |
| In Progress | 进行中，任务正在执行 | 蓝色 |
| On Hold | 挂起，任务暂停 | 黄色 |
| Blocked | 阻塞，任务被阻止 | 红色 |
| Completed | 已完成 | 绿色 |
| Delayed | 延迟，超过计划时间未完成 | 橙色 |

## 功能特性

### 1. 设置任务进展

在任务详情弹窗中修改进展状态：
- 点击任意任务打开 TaskDetailModal
- 找到"进展"选项
- 从下拉列表选择适合的进展状态
- 点击"完成"保存更改

### 2. 查看任务进展

进展状态在所有视图中均可见：

#### 表格视图
- 第四列显示"进展"列
- 显示为 Activity 图标 + 状态文字
- 支持筛选功能，可按进展状态过滤任务

#### 日历视图
- 每月视图中的任务卡片上显示进展图标
- 图标颜色表示当前进展状态

#### 四象限视图
- 每个象限中的任务显示进展图标
- 与象限图标并排显示

#### 日视图
- 时间线上的任务块中显示进展图标
- 全天任务列表中同样显示进展图标

### 3. 自动状态同步

- 当标记任务为完成时，进展自动设置为"Completed"
- 新建任务默认进展为"Initial"
- 编辑任务时可手动修改进展状态

### 4. 数据导入导出

#### 导出功能
- 新版本导出的数据包含 `progress` 字段
- 备份版本号更新为 v1.1

#### 导入功能
- 支持导入旧版本数据（v1.0）
- 自动为旧数据添加 `progress` 字段：
  - 已完成任务 → "Completed"
  - 未完成任务 → "Initial"
- 新版本数据直接保留 `progress` 字段

## 技术实现

### 数据库迁移
- 数据库版本升级到 v4
- 自动为已有数据添加 progress 字段
- 迁移规则：
  - 已完成的任务 → "Completed"
  - 有 endDate 且已过期的任务 → "Delayed"
  - 其他任务 → "Initial"

### 向后兼容
- 所有视图都兼容没有 `progress` 字段的历史数据
- 缺失字段时默认显示为 "Initial"
- 导入导出逻辑确保数据平滑迁移

## 使用示例

### 场景 1：跟踪项目任务
1. 创建项目任务，进展默认为 "Initial"
2. 开始执行任务时，修改为 "In Progress"
3. 遇到问题时，改为 "Blocked"
4. 需要暂停时，改为 "On Hold"
5. 完成后，标记为完成，进展自动变为 "Completed"

### 场景 2：管理延期任务
- 对于过期的任务，系统会自动识别并设置进展为 "Delayed"
- 可在表格视图中筛选所有 "Delayed" 任务，集中处理

### 场景 3：数据迁移
- 从旧版本导入数据时，无需手动更新
- 系统自动为每个任务分配合适的进展状态
- 导出数据时，进展状态包含在备份文件中

## 最佳实践

1. **及时更新进展**：养成在任务状态变化时更新进展的习惯
2. **使用筛选功能**：在表格视图中按进展筛选，快速定位需要关注的任务
3. **关注延迟任务**：定期检查 "Delayed" 状态的任务，调整计划
4. **团队同步**：进展图标提供快速视觉反馈，便于团队协作

## 注意事项

- 进展状态和完成状态是独立的，可以同时存在
- 例如：任务可以标记为完成（completed=true），但进展仍为 "In Progress"（手动设置的）
- 建议保持两者一致以获得最准确的状态跟踪
